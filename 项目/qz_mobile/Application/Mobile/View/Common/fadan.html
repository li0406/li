<script type="text/javascript" src="//assets.qizuang.com/g-js/jquery/1.11.1/jquery.min.js"></script>
<!--报价发单弹窗-->
<div class="new-baojia new-box new-box1">
    <div class="baojia-tit">8秒计算装修需要多少钱</div>
    <div class="money-img">
        <div class="" style="float: right;">
            <div class="num num-gray"></div>
            <div class="num num-gray"></div>
            <div id="num-1" class="num num-1"></div>
            <div id="num-2" class="num num-2"></div>
            <div id="num-3" class="num num-0"></div>
            <div id="num-4" class="num num-4"></div>
            <div id="num-5" class="num num-5"></div>
            <div id="num-6" class="num num-8"></div>
            <span> 元</span>
        </div>
    </div>
    <div>
        <ul class="new-fadan">
            <li>
                <button id="showCityPicker2" class="new-city" type="button">
                    <i class="fa fa-map-marker">
                    </i>
                    <empty name="mapUseInfo">
                        请选择
                        <else/>
                        {$mapUseInfo.provincefull} {$mapUseInfo.name} {$mapUseInfo.cityarea}
                    </empty>
                </button>
                <input type="hidden" name="province" data-id="{$mapUseInfo.pid}">
                <input type="hidden" name="city" data-id="{$mapUseInfo.id}">
                <input type="hidden" name="area" data-id="{$mapUseInfo.areaid}">
                <span class="xiajiao"></span>
            </li>
            <li>
                <input class="new-mianji" type="number" oninput="if(value.length>5)value=value.slice(0,5)" name="mianji" placeholder="请输入您的房屋面积">
                <span class="dw">㎡</span>
            </li>
            <li>
                <input class="new-tele" type="tel" maxlength="11" name="tel-number"
                       placeholder="输入手机号获取计算结果">
            </li>
        </ul>
    </div>
    <div id="new-shenming">
        <input type="checkbox" checked="checked" id="new-mianze">
        <label for="new-mianze" id="new-check" class="fa fa-check"></label>
        <span>我已阅读并同意齐装网的</span>
        <a rel="nofollow" href="{$SCHEME_HOST.scheme_full}{$SCHEME_HOST.host}/about/disclaimer-no"><span>《免责声明》</span></a>
    </div>
    <div class="new-click-btn new-baojia-btn summ-baojia">
        <img src="/assets/mobile/index/img/baojia-btn.gif"/>
    </div>
</div>
<!--设计发单弹窗-->
<div class="new-sheji new-box new-box2">
    <div class="sheji-tit">免费领取四份设计方案</div>
    <div class="sheji-minge">
        <span class="top">今日还剩</span>
        <span class="sheji-num" id="bai">0</span>
        <span class="sheji-num" id="shi">4</span>
        <span class="sheji-num" id="ge">8</span>
        <span class="top">免费名额</span>
    </div>
    <div>
        <ul class="new-fadan">
            <li>
                <button id="showCityPicker3" class="new-city" type="button">
                    <i class="fa fa-map-marker">
                    </i>
                    <empty name="mapUseInfo">
                        请选择
                        <else/>
                        {$mapUseInfo.provincefull} {$mapUseInfo.name} {$mapUseInfo.cityarea}
                    </empty>
                </button>
                <input type="hidden" name="province" data-id="{$mapUseInfo.pid}">
                <input type="hidden" name="city" data-id="{$mapUseInfo.id}">
                <input type="hidden" name="area" data-id="{$mapUseInfo.areaid}">
            </li>
            <li>
                <input class="new-name" name="name" placeholder="请输入您的姓名">
                <span class="dw">㎡</span>
            </li>
            <li>
                <input class="new-tele" type="tel" maxlength="11" name="tel-number2"
                       placeholder="输入手机号获取设计方案">
            </li>
        </ul>
    </div>
    <div id="new-shenming2">
        <input type="checkbox" checked="checked" id="new-mianze2">
        <label for="new-mianze2" id="new-check2" class="fa fa-check"></label>
        <span>我已阅读并同意齐装网的</span>
        <a rel="nofollow" href="{$SCHEME_HOST.scheme_full}{$SCHEME_HOST.host}/about/disclaimer-no"><span>《免责声明》</span></a>
    </div>
    <div class="new-click-btn new-sheji-btn">
        <img src="/assets/mobile/index/img/sheji-btn.gif"/>
    </div>
</div>
<!--报价发单成功弹窗-->
<div class="baojia-success-dialog">
    <div class="baojia-success-content">
        <img class="close-dialog" src="/assets/mobile/index/img/close-daohang.png" />
        <div class="baojia-success-title">
            装修预算报价为：<span>480000</span>元
        </div>
        <div class="baojia-success-details">
            <div class="new-wsj">
                <p>卫生间：</p>
                <p><span class="money">17100</span>元</p>
            </div>
            <div class="new-cf">
                <p>厨房：</p>
                <p><span class="money">17100</span>元</p>
            </div>
            <div class="new-kt">
                <p>客厅：</p>
                <p><span class="money">17100</span>元</p>
            </div>
            <div class="new-sd">
                <p>水电：</p>
                <p><span class="money">17100</span>元</p>
            </div>
            <div class="new-ws">
                <p>卧室：</p>
                <p><span class="money">17100</span>元</p>
            </div>
            <div class="new-other">
                <p>其他：</p>
                <p><span class="money">17100</span>元</p>
            </div>
        </div>
       
        <!-- 二维码 -->
        <div class="bama_s">
            <div class="bgc_fff">
                <div class="bama_img"><img src="//{:C('QINIU_DOMAIN')}/custom/20201130/Fgnn6z_ns6sU2-w9dKln98tQ1W6k" alt=""></div>
                <div class="bama_text">
                    <p class="first_bama">微信&nbsp;&nbsp;<span class="bama_apn">扫一扫</span>&nbsp;&nbsp;关注服务进度</p>
                    <p>长按&nbsp;&nbsp;<span class="bama_apn">二维码</span>&nbsp;&nbsp;保存左侧图片 </p>
                </div>
            </div>
        </div>

    </div>
</div>
<script type="text/javascript">
    $(function () {
        // 获取随机数的方法
        function GetRandomNum(Min, Max) {
            var Range = Max - Min;
            var Rand = Math.random();
            return (Min + Math.round(Rand * Range));
        }

        // 随机数
        var timer = setInterval(function () {
            var num = GetRandomNum(30000, 120000) + '';
            if (num < 99999) {
                var num1 = 'num num-gray',
                    num2 = 'num num-' + num.charAt(0),
                    num3 = 'num num-' + num.charAt(1),
                    num4 = 'num num-' + num.charAt(2),
                    num5 = 'num num-' + num.charAt(3),
                    num6 = 'num num-' + num.charAt(4);
            } else {
                var num1 = 'num num-' + num.charAt(0),
                    num2 = 'num num-' + num.charAt(1),
                    num3 = 'num num-' + num.charAt(2),
                    num4 = 'num num-' + num.charAt(3),
                    num5 = 'num num-' + num.charAt(4),
                    num6 = 'num num-' + num.charAt(5);
            }
            $('#num-1').removeClass().addClass(num1);
            $('#num-2').removeClass().addClass(num2);
            $('#num-3').removeClass().addClass(num3);
            $('#num-4').removeClass().addClass(num4);
            $('#num-5').removeClass().addClass(num5);
            $('#num-6').removeClass().addClass(num6);

        }, 400);

        // 报价


        function comBaojia(source) {
            var checked = $("#new-mianze").is(':checked');
            window.order({
                extra: {
                    cs: $('input[name=city]').attr('data-id'),
                    qx: $('input[name=area]').attr('data-id'),
                    mianji: $(".new-fadan input[name=mianji]").val(),
                    tel: $(".new-fadan input[name=tel-number]").val(),
                    source: source
                },
                submitBtn: {
                    className: $(this),
                    type: 'btn'
                },
                error: function () {
                    alert("发生了未知的错误,请稍后再试！");
                },
                success: function (data, status, xhr) {
                    if (data.status == 1) {
                        $.ajax({
                            url: "/getdetailsbyajax",
                            type: 'GET',
                            dataType: 'JSON',
                            data: {}
                        }).done(function (res) {
                            if (res.status == 1) {
                                $(".baojia-success-title span").html(res.data.total);
                                $(".new-wsj span").html(res.data.child.wsj);
                                $(".new-cf span").html(res.data.child.cf);
                                $(".new-kt span").html(res.data.child.kt);
                                $(".new-sd span").html(res.data.child.sd);
                                $(".new-ws span").html(res.data.child.zw);
                                $(".new-other span").html(res.data.child.other);

                                $(".baojia-success-dialog").show()
                            } else {
                                alert(res.info)
                            }
                        })
                    } else {
                        alert(data.info)
                    }
                },
                validate: function (item, value, method, info) {
                    if (('cs' == item || 'qx' == item) && 'notempty' == method) {
                        alert('请选择城市')
                        return false;
                    }
                    if ('mianji' == item && 'notempty' == method) {
                        alert('请填写房屋面积')
                        return false;
                    }
                    if ('mianji' == item && 'isnumber' == method) {
                        alert('房屋面积请输入1-1000之间的数字')
                        return false;
                    }
                    ;
                    if ('mianji' == item) {
                        if ($(".new-fadan input[name=mianji]").val() < 1) {
                            alert('房屋面积请输入1-1000之间的数字')
                            return false
                        }
                        if ($(".new-fadan input[name=mianji]").val() > 1000) {
                            alert('房屋面积请输入1-1000之间的数字')
                            return false
                        }
                    }
                    if ('tel' == item && 'notempty' == method) {
                        alert('您还没有填写手机号噢！')
                        $(".new-fadan input[name=tel-number]").focus();
                        return false;
                    }
                    if ('tel' == item && 'ismobile' == method) {
                        alert('请填写正确的手机号码！')
                        $(".new-fadan input[name=tel-number]").focus();
                        return false;
                    }
                    if (!checked) {
                        alert('请勾选我已阅读并同意齐装网的《免责声明》！')
                        return false;
                    }
                    return true;
                }
            });
        }
        var source = $(".source_new").val()
        $('.new-baojia-btn').on('click', function () {
            comBaojia(source)
        });
        // 关闭弹窗
        $("body").on("click",".close-dialog",function () {
            $(".baojia-success-dialog").hide()
        })

        // 设计
        $('.new-sheji-btn').on('click', function () {
            var checked = $("#new-mianze2").is(':checked');
            window.order    ({
                extra: {
                    cs: $('input[name=city]').attr('data-id'),
                    qx: $('input[name=area]').attr('data-id'),
                    name: $(".new-fadan input[name=name]").val(),
                    tel: $(".new-fadan input[name=tel-number2]").val(),
                    source: '312'
                },
                submitBtn: {
                    className: $(this),
                    type: 'btn'
                },
                error: function () {
                    alert("发生了未知的错误,请稍后再试！");
                },
                success: function (data, status, xhr) {
                    if (data.status == 1) {
                        window.location.href = "/baojiawanshan/"
                    } else {
                        alert(data.info)
                    }
                },
                validate: function (item, value, method, info) {
                    if (('cs' == item || 'qx' == item) && 'notempty' == method) {
                        alert('请选择城市')
                        return false;
                    }
                    if ('name' == item && '' != method) {
                        alert(info);
                        $(".new-fadan input[name=name]").focus();
                        return false;
                    }
                    if ('tel' == item && 'notempty' == method) {
                        alert('您还没有填写手机号噢！')
                        $(".new-fadan input[name=tel-number]").focus();
                        return false;
                    }
                    if ('tel' == item && 'ismobile' == method) {
                        alert('请填写正确的手机号码！')
                        $(".new-fadan input[name=tel-number]").focus();
                        return false;
                    }
                    if (!checked) {
                        alert('请勾选我已阅读并同意齐装网的《免责声明》！')
                        return false;
                    }
                    return true;
                }
            });
        });

        //切换免责对勾
        $("#new-check").click(function () {
            $(this).toggleClass('fa-check');
        })
        //切换免责对勾
        $("#new-check2").click(function () {
            $(this).toggleClass('fa-check');
        })

        // 随机二维码
        function mathRandom() {
            var path = ''
            var randoms = parseInt(Math.random()*4)
            switch(randoms) {
                case 0:
                    path = '//staticqn.qizuang.com/custom/20201204/FvJcD2MWdAVjYAwNPAWjaRnLM5zi'
                    break;
                case 1:
                    path = '//staticqn.qizuang.com/custom/20201204/FvVRpUHpPaOCfx3MU49ge7jyPxme'
                    break;
                case 2:
                    path = '//staticqn.qizuang.com/custom/20201204/Fij1vnOefYhRlOOhcZDiLPImXRrG'
                    break;
                case 3:
                    path = '//staticqn.qizuang.com/custom/20201204/FplriUHf5JQgZp6eipcSaF5gtVhf'
                    break;
            }
            $('.bama_img>img').attr('src', path)
        }
        mathRandom()

    })

</script>
