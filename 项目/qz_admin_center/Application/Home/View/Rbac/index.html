<!DOCTYPE html>
<!--[if IE 8]> <html lang="zh-CN" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="zh-CN" class="ie9"> <![endif]-->
<!--[if !IE]><![endif]-->
<html lang="zh-CN">
<head>
 <meta charset="utf-8" />
    <title>权限管理-用户中心</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link href="/assets/common/css/bootstrap.min.new.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link href="/assets/common/css/bootstrap-responsive.min.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link href="/assets/common/css/font-awesome.min.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link href="/assets/common/css/style-metro.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link href="/assets/common/css/bootstrap-tree.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/assets/common/css/style-metro.css?v={:C('STATIC_VERSION')}" />
    <link rel="stylesheet" type="text/css" href="/assets/common/css/multi-select-metro.css?v={:C('STATIC_VERSION')}" />
    <link rel="stylesheet" type="text/css" href="/assets/common/css/inbox.css?v={:C('STATIC_VERSION')}" />
    <link rel="stylesheet" type="text/css" href="/assets/common/css/uniform.default.css?v={:C('STATIC_VERSION')}" />
    <link href="/assets/home/css/main.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <script src="/assets/common/js/jquery.min.js?v={:C('STATIC_VERSION')}" type="text/javascript"></script>
</head>
<body>
    <include file="Main:header" />
    <div class="container mt10 inner-box basic-box">
        <div class="row">
            <include file="Rbac:navleft" />
            <div class="col-sm-9 basic-right">
                <div class="row">
                    <div class="col-sm-12 form-horizontal">
                        <div class="basic-setting-title">
                            <h3>权限菜单</h3>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-8 col-sm-offset-2 alert alert-danger text-center hide">
                                <button class="close" data-dismiss="alert"></button>
                                <span></span>
                            </div>
                        </div>
                        <div class="col-sm-10 col-sm-offset-1 role-setting-content">
                            <div class="ms-container">
                                <select id="my_multi_select" multiple="multiple">
                                    <volist name="department" id="vo" key="key">
                                        <optgroup label="{$vo.name}">
                                        <volist name="vo.roles" id="v" key="k">
                                            <if condition="array_key_exists($v['id'],$roles)">
                                                <option value="{$v.id}" data-group="{$vo.id}" selected="selected" class="ms-selected" >{$v.role_name}</option>
                                            <else/>
                                                <option value="{$v.id}" data-group="{$vo.id}"  class="ms-selected" >{$v.role_name}</option>
                                            </if>
                                        </volist>
                                        </optgroup>
                                    </volist>
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb10">
                            <div class="col-sm-2 col-sm-offset-1">
                                <button id="btnSave" type="sbumit" class="btn btn-block blue">保存</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 form-horizontal inbox">
                        <div class="basic-setting-title">
                            <h3>在线系统</h3>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-8 col-sm-offset-2 alert alert-danger text-center hide alert-sec">
                                <button class="close" data-dismiss="alert"></button>
                                <span></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-3">
                                <ul class="ver-inline-menu tabbable">
                                    <li class="active">
                                        <a data-toggle="tab" href="#tab1" data-id="2">
                                            <i class="icon-desktop" ></i>
                                            管理系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="5">
                                            <i class="icon-desktop" ></i>
                                            新版管理系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="7">
                                            <i class="icon-desktop" ></i>
                                            运营系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="8">
                                            <i class="icon-desktop" ></i>
                                            家具管理系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="9">
                                            <i class="icon-desktop" ></i>
                                            cpa管理系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="10">
                                            <i class="icon-desktop" ></i>
                                            装修说管理系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="11">
                                            <i class="icon-desktop" ></i>
                                            云管家-商家端
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="12">
                                            <i class="icon-desktop" ></i>
                                            销售系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="13">
                                            <i class="icon-desktop" ></i>
                                            短信网关
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="14">
                                            <i class="icon-desktop" ></i>
                                            软文管理系统
                                        </a>
                                    </li>
                                    <li class="">
                                        <a data-toggle="tab" href="#tab3" data-id="15">
                                            <i class="icon-desktop" ></i>
                                            数据驾驶舱
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="col-sm-9">
                                <div class="tab-content">
                                    <div id="tab1" class="tab-pane active">
                                        {$sys_tmp}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script src="/assets/common/js/jquery-migrate-1.2.1.min.js?v={:C('STATIC_VERSION')}" type="text/javascript"></script>
<script src="/assets/common/js/bootstrap.min.js?v={:C('STATIC_VERSION')}" type="text/javascript"></script>
<script src="/assets/common/js/placeholders.min.js?v={:C('STATIC_VERSION')}" type="text/javascript"></script>
<script type="text/javascript" src="/assets/common/js/jquery.multi-select.js?v={:C('STATIC_VERSION')}"></script>
<script src="/assets/home/js/multi.js?v={:C('STATIC_VERSION')}"></script>
<script type="text/javascript">
     FormComponents.init();
     $("#btnSave").click(function(event) {
        var val = null;
        $('#my_multi_select').multiSelect("getValue",function(args){ val = args;});
        $.ajax({
            url: '/saverole',
            type: 'POST',
            dataType: 'JSON',
            data: {
                ids: val
            }
        })
        .done(function(data) {
             $(".alert-danger").removeClass('hide').find("span").html(data.info);
        })
        .fail(function(xhr) {
            $(".alert-error").html("系统异常,请联系技术部门！");
        });
     });

     $(".ver-inline-menu li a").click(function(event) {
        var id = $(this).attr("data-id");

        $.ajax({
            url: '/systemrole',
            type: 'GET',
            dataType: 'JSON',
            data: {id: id}
        })
        .done(function(data) {
            $("#tab1").html(data.data);
        })
        .fail(function(xhr) {
            $(".alert-sec").html("系统异常,请联系技术部门！");

        });
     });
</script>
</html>